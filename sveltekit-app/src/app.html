<!doctype html>
<html lang="en">
	<head>
		<script
			type="text/javascript"
			src="https://embeds.iubenda.com/widgets/1c622cdd-ce1f-43ab-8134-14bef5aced8b.js"
		></script>
		<meta charset="utf-8" />
		<link rel="icon" href="%sveltekit.assets%/favicon.svg" />
		<meta name="viewport" content="width=device-width" />
		<!-- External scripts -->
		<!-- Matomo -->
		<script>
			var _paq = (window._paq = window._paq || []);
			/* tracker methods like "setCustomDimension" should be called before "trackPageView" */
			_paq.push(['trackPageView']);
			_paq.push(['enableLinkTracking']);
			(function () {
				var u = '//joia.it/matomo/';
				_paq.push(['setTrackerUrl', u + 'matomo.php']);
				_paq.push(['setSiteId', '1']);
				var d = document,
					g = d.createElement('script'),
					s = d.getElementsByTagName('script')[0];
				g.async = true;
				g.src = u + 'matomo.js';
				s.parentNode.insertBefore(g, s);
			})();
		</script>
		<!-- StampReady Newsletter -->
		<script
			type="text/javascript"
			src="https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"
		></script>
		<script type="text/javascript" src="https://www.stampready.net/api2/api.js"></script>
		<script async="false">
			// Track which input was last focused
			let lastFocusedInput = null;

			// Add event listeners when page loads
			document.addEventListener('DOMContentLoaded', function () {
				const asideInput = document.getElementById('newsletter-aside');
				const footerInput = document.getElementById('newsletter-footer');

				if (asideInput) {
					asideInput.addEventListener('focus', function () {
						lastFocusedInput = 'newsletter-aside';
					});
				}
				if (footerInput) {
					footerInput.addEventListener('focus', function () {
						lastFocusedInput = 'newsletter-footer';
					});
				}
			});

			function updateNewsletterInput(message) {
				// Try to use the last focused input, otherwise update both
				if (lastFocusedInput) {
					const input = document.getElementById(lastFocusedInput);
					if (input) {
						const originalPlaceholder = input.placeholder;
						input.value = '';
						input.placeholder = message;
						setTimeout(() => {
							input.placeholder = originalPlaceholder;
						}, 3000);
						return;
					}
				}

				// Fallback: update all newsletter inputs
				const inputs = [
					document.getElementById('newsletter-aside'),
					document.getElementById('newsletter-footer')
				];

				inputs.forEach((input) => {
					if (input) {
						const originalPlaceholder = input.placeholder;
						input.value = '';
						input.placeholder = message;
						setTimeout(() => {
							input.placeholder = originalPlaceholder;
						}, 3000);
					}
				});
			}

			function error() {
				updateNewsletterInput('Error occurred, please try again');
			}

			function exists() {
				updateNewsletterInput('Email already exists');
			}

			function success() {
				updateNewsletterInput('Email submitted correctly!');
			}

			function confirm() {
				updateNewsletterInput('Please confirm by email');
			}
		</script>

		%sveltekit.head%
	</head>
	<body data-sveltekit-preload-data="hover">
		<div style="display: contents">%sveltekit.body%</div>
	</body>
</html>
